<svg viewBox="0 0 900 420" width="900" height="420" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#1a1f2a" stroke-width="0.5"/>
    </pattern>
    <marker id="arr" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#3a4560"/></marker>
    <filter id="glow-pink"><feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#f472b6" flood-opacity="0.15"/></filter>
    <filter id="glow-gold"><feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#fbbf24" flood-opacity="0.15"/></filter>
    <filter id="glow-green"><feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#34d399" flood-opacity="0.15"/></filter>
    <filter id="glow-orange"><feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#fb923c" flood-opacity="0.15"/></filter>
    <filter id="glow-purple"><feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#a78bfa" flood-opacity="0.15"/></filter>
  </defs>
  <rect width="900" height="420" rx="12" fill="#0c0e12"/>
  <rect width="900" height="420" rx="12" fill="url(#grid)"/>

  <!-- Title -->
  <text x="450" y="28" text-anchor="middle" fill="#f472b6" font-family="Segoe UI,Helvetica,Arial,sans-serif" font-size="14" font-weight="700" letter-spacing="2">VLLM ARCHITECTURE (V1 ENGINE)</text>

  <!-- Serving Layer -->
  <rect x="20" y="55" width="185" height="155" rx="10" fill="#141820" stroke="#f472b6" stroke-width="1.5" filter="url(#glow-pink)"/>
  <text x="112" y="80" text-anchor="middle" fill="#f472b6" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">SERVING LAYER</text>
  <line x1="50" y1="88" x2="175" y2="88" stroke="#f472b6" stroke-width="0.5" opacity="0.3"/>
  <text x="112" y="110" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">OpenAI-compat API</text>
  <text x="112" y="130" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">AsyncIO server</text>
  <text x="112" y="150" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Chat / Completion</text>
  <text x="112" y="170" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Embedding / Classify</text>

  <!-- Arrow Serving→Client -->
  <path d="M 210 100 L 248 90" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>
  <!-- Arrow Serving→Core -->
  <path d="M 210 160 L 248 175" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Engine Client -->
  <rect x="255" y="55" width="175" height="90" rx="10" fill="#141820" stroke="#f472b6" stroke-width="1.5" filter="url(#glow-pink)"/>
  <text x="342" y="80" text-anchor="middle" fill="#f472b6" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">ENGINE CLIENT</text>
  <line x1="285" y1="88" x2="400" y2="88" stroke="#f472b6" stroke-width="0.5" opacity="0.3"/>
  <text x="342" y="110" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Lifecycle management</text>
  <text x="342" y="130" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">IPC coordination</text>

  <!-- Core Engine -->
  <rect x="255" y="160" width="175" height="120" rx="10" fill="#141820" stroke="#f472b6" stroke-width="1.5" filter="url(#glow-pink)"/>
  <text x="342" y="185" text-anchor="middle" fill="#f472b6" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">CORE ENGINE</text>
  <line x1="285" y1="193" x2="400" y2="193" stroke="#f472b6" stroke-width="0.5" opacity="0.3"/>
  <text x="342" y="215" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Scheduling queues</text>
  <text x="342" y="235" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Tokenization</text>
  <text x="342" y="255" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Output processing</text>
  <text x="342" y="270" text-anchor="middle" fill="#6b7a90" font-family="Segoe UI,sans-serif" font-size="11">Preemption support</text>

  <!-- Arrow Client→Core -->
  <path d="M 342 147 L 342 155" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>
  <!-- Arrow Core→Paged -->
  <path d="M 435 220 L 475 170" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>

  <!-- PagedAttention -->
  <rect x="480" y="55" width="195" height="225" rx="10" fill="#141820" stroke="#34d399" stroke-width="1.5" filter="url(#glow-green)"/>
  <text x="577" y="80" text-anchor="middle" fill="#34d399" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">PAGEDATTENTION</text>
  <line x1="510" y1="88" x2="645" y2="88" stroke="#34d399" stroke-width="0.5" opacity="0.3"/>
  <text x="577" y="110" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Block-based KV cache</text>
  <text x="577" y="132" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Virtual memory paging</text>
  <text x="577" y="154" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Logical → Physical map</text>
  <text x="577" y="176" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Copy-on-write sharing</text>
  <text x="577" y="198" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Block table tracking</text>
  <text x="577" y="220" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Prefix caching (APC)</text>
  <text x="577" y="242" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Swapping / recompute</text>
  <!-- Mini block illustration -->
  <rect x="510" y="256" width="18" height="12" rx="2" fill="#34d399" opacity="0.15" stroke="#34d399" stroke-width="0.6"/>
  <rect x="532" y="256" width="18" height="12" rx="2" fill="#34d399" opacity="0.25" stroke="#34d399" stroke-width="0.6"/>
  <rect x="554" y="256" width="18" height="12" rx="2" fill="#34d399" opacity="0.15" stroke="#34d399" stroke-width="0.6"/>
  <rect x="576" y="256" width="18" height="12" rx="2" fill="none" stroke="#34d399" stroke-width="0.6" stroke-dasharray="2"/>
  <rect x="598" y="256" width="18" height="12" rx="2" fill="#34d399" opacity="0.25" stroke="#34d399" stroke-width="0.6"/>
  <rect x="620" y="256" width="18" height="12" rx="2" fill="none" stroke="#34d399" stroke-width="0.6" stroke-dasharray="2"/>
  <rect x="642" y="256" width="18" height="12" rx="2" fill="#34d399" opacity="0.15" stroke="#34d399" stroke-width="0.6"/>

  <!-- Arrow Paged→Executor -->
  <path d="M 680 165 L 715 165" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Executor / Workers -->
  <rect x="720" y="55" width="160" height="225" rx="10" fill="#141820" stroke="#fb923c" stroke-width="1.5" filter="url(#glow-orange)"/>
  <text x="800" y="80" text-anchor="middle" fill="#fb923c" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">EXECUTOR</text>
  <line x1="745" y1="88" x2="855" y2="88" stroke="#fb923c" stroke-width="0.5" opacity="0.3"/>
  <text x="800" y="110" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Worker processes</text>
  <text x="800" y="132" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Model Runner</text>
  <text x="800" y="154" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">TP / PP parallelism</text>
  <text x="800" y="180" text-anchor="middle" fill="#6b7a90" font-family="Segoe UI,sans-serif" font-size="11">Multi-backend:</text>
  <text x="800" y="200" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">FlashAttn / FlashInfer</text>
  <text x="800" y="222" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">CUDA / ROCm / TPU</text>
  <text x="800" y="244" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Neuron / Gaudi</text>
  <!-- GPU icons -->
  <rect x="755" y="258" width="16" height="12" rx="2" fill="none" stroke="#fb923c" stroke-width="0.8" opacity="0.3"/>
  <rect x="777" y="258" width="16" height="12" rx="2" fill="none" stroke="#fb923c" stroke-width="0.8" opacity="0.3"/>
  <rect x="799" y="258" width="16" height="12" rx="2" fill="none" stroke="#fb923c" stroke-width="0.8" opacity="0.3"/>
  <rect x="821" y="258" width="16" height="12" rx="2" fill="none" stroke="#fb923c" stroke-width="0.8" opacity="0.3"/>

  <!-- Continuous Batching -->
  <rect x="255" y="305" width="255" height="75" rx="10" fill="#141820" stroke="#fbbf24" stroke-width="1.5" filter="url(#glow-gold)"/>
  <text x="382" y="330" text-anchor="middle" fill="#fbbf24" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">CONTINUOUS BATCHING</text>
  <line x1="290" y1="338" x2="475" y2="338" stroke="#fbbf24" stroke-width="0.5" opacity="0.3"/>
  <text x="382" y="358" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Dynamic batch formation</text>
  <text x="382" y="373" text-anchor="middle" fill="#6b7a90" font-family="Segoe UI,sans-serif" font-size="11">per-iteration scheduling</text>

  <!-- llm-d -->
  <rect x="530" y="305" width="210" height="75" rx="10" fill="#141820" stroke="#a78bfa" stroke-width="1.5" filter="url(#glow-purple)"/>
  <text x="635" y="330" text-anchor="middle" fill="#a78bfa" font-family="Consolas,monospace" font-size="11" font-weight="700" letter-spacing="1">LLM-D (K8S STACK)</text>
  <line x1="560" y1="338" x2="710" y2="338" stroke="#a78bfa" stroke-width="0.5" opacity="0.3"/>
  <text x="635" y="358" text-anchor="middle" fill="#a0aabb" font-family="Segoe UI,sans-serif" font-size="12">Disaggregated P/D serving</text>
  <text x="635" y="373" text-anchor="middle" fill="#6b7a90" font-family="Segoe UI,sans-serif" font-size="11">Red Hat · Google · IBM · NVIDIA</text>

  <!-- Arrows down -->
  <path d="M 342 282 L 382 300" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>
  <path d="M 577 282 L 635 300" stroke="#3a4560" stroke-width="2" marker-end="url(#arr)"/>

  <!-- Footer -->
  <text x="20" y="410" fill="#f472b6" font-family="Consolas,monospace" font-size="10" opacity="0.4">Modular, plugin-based architecture optimized for broad compatibility</text>
</svg>
